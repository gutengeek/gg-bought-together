!function(i){var n=null,s={init:function(){s.sortableInit(),s.searchProducts(),s.addResults(),s.dependencies(),s.removeProduct(),s.refreshIds()},sortableInit:function(){var t=i("#gg_woo_bt_selected ul");t.length&&t.sortable({cursor:"move",stop:function(t,o){s.getIds()}}).disableSelection()},searchProducts:function(){i("#gg_woo_bt_search").keyup(function(){var o=i("#gg_woo_bt_search").val(),e=i("#gg_woo_bt_loading"),_=i("#gg_woo_bt_results");if(""!==o)return e.show(),null!=n&&clearTimeout(n),n=setTimeout(function(){n=null;var t={action:"gg_woo_bt_get_search_results",keyword:o,id:i("#gg_woo_bt_id").val(),ids:i("#gg_woo_bt_ids").val()};i.ajax({url:ajaxurl,method:"POST",data:t}).done(function(t){_.show(),_.html(t),e.hide(),s.addResults()})},300),!1;_.hide()})},addResults:function(){i("#gg_woo_bt_results li").on("click",function(){var o=i(this),t=i(this).data("id");i.ajax({url:ajaxurl,method:"POST",data:{action:"gg_woo_bt_add_result_product_meta",id:t}}).done(function(t){t&&(o.remove(),i("#gg_woo_bt_selected ul").append(t),i("#gg_woo_bt_results").hide(),i("#gg_woo_bt_results li").remove(),i("#gg_woo_bt_search").val(""),s.reInitWCToolTip(),s.sortableInit(),s.removeProduct(),s.getIds())})})},reInitWCToolTip:function(){i(".tips, .help_tip, .woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})},getIds:function(){var t=new Array,o=i("#gg_woo_bt_ids");i("#gg_woo_bt_selected li").each(function(){i(this).hasClass("gg_woo_bt_default")||t.push(i(this).attr("data-id")+"/"+i(this).find("input.gg_woo_bt_price").val()+"/"+i(this).find("input.gg_woo_bt_qty").val())}),t.length?o.val(t.join(",")):o.val("")},refreshIds:function(){i("#gg_woo_bt_selected").on("keyup change click","input",function(){return s.getIds(),!1})},dependencies:function(){i("#gg_woo_bt_custom_qty").on("click",function(){i(this).is(":checked")?(i(".gg_woo_bt_tr_show_if_custom_qty").show(),i(".gg_woo_bt_tr_hide_if_custom_qty").hide()):(i(".gg_woo_bt_tr_show_if_custom_qty").hide(),i(".gg_woo_bt_tr_hide_if_custom_qty").show())})},removeProduct:function(){i("#gg_woo_bt_selected span.remove").on("click",function(){return i(this).closest("li").remove(),s.getIds(),!1})}};i(s.init)}(jQuery);